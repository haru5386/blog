---
title: å¾ JavaScript åˆ° TypeScriptï¼šä¸€æ¬¡ææ‡‚ class çš„å®Œæ•´ç”¨æ³•
date: 2025-05-07
category: javascript
abstract: æœ¬æ–‡å¾æœ€åŸºæœ¬çš„ class èªæ³•é–‹å§‹ï¼Œå¸¶ä½ ä¸€æ­¥æ­¥èªè­˜ JavaScript çš„ç‰©ä»¶å°å‘å¯«æ³•ï¼ŒåŒ…æ‹¬å»ºæ§‹å­ã€æ–¹æ³•ã€ç¹¼æ‰¿ã€getter/setterã€éœæ…‹å±¬æ€§ç­‰ç”¨æ³•ï¼Œä¸¦å»¶ä¼¸åˆ° TypeScript ä¸­çš„ privateã€protectedã€readonly ç­‰ä¿®é£¾è©ã€‚ç„¡è«–ä½ æ˜¯åœ¨çœ‹ Vue åº•å±¤åŸå§‹ç¢¼ï¼Œé‚„æ˜¯æƒ³ç”¨ class ç®¡ç†è¤‡é›œé‚è¼¯ï¼Œé€™ç¯‡ç­†è¨˜éƒ½èƒ½å¹«åŠ©ä½ é‡æ–°æŒæ¡ class çš„æ ¸å¿ƒæ¦‚å¿µèˆ‡æœ€ä½³å¯¦è¸ã€‚
tags: [javascriptã€classã€OOP]
---

å› ç‚ºæˆ‘åœ¨çœ‹ Vue åº•å±¤çš„å¯«æ³•ï¼Œæ‰€ä»¥å…ˆä¾†è¤‡ç¿’ä¸€ä¸‹ class çš„ç”¨æ³•ï¼ŒJavaScript æ˜¯ç‰©ä»¶å°å‘èªè¨€ï¼ˆOOPï¼‰ã€‚class æ˜¯ç”¨ä¾†å»ºç«‹å¯ä»¥é‡è¤‡ä½¿ç”¨çš„ç‰©ä»¶æ¨¡æ¿ï¼Œè®“ä½ å¯ä»¥å¿«é€Ÿå»ºç«‹å¾ˆå¤šåŠŸèƒ½ä¸€è‡´çš„å¯¦ä¾‹ã€‚class æ˜¯ä¸€ç¨®èªæ³•ç³–ï¼ŒèƒŒå¾Œä»ç„¶æ˜¯ä»¥ JavaScript åŸæœ¬çš„ã€ŒåŸå‹ï¼ˆprototypeï¼‰ã€æ©Ÿåˆ¶é‹ä½œçš„ï¼Œæ˜¯ES6ï¼ˆ2015ï¼‰æ‰å¼•å…¥çš„ã€‚

### class çš„åŸºæœ¬èªæ³•

``` c
class Person {
  constructor(name, age) {
    this.name = name
    this.age = age
  }

  sayHello() {
    console.log(`Hi, I'm ${this.name} and I'm ${this.age} years old.`)
  }
}

const p = new Person('Alice', 25)
p.sayHello() // ğŸ‘‰ Hi, I'm Alice and I'm 25 years old.

```

| èªæ³•          | ç”¨é€”                            |
| ------------- | ------------------------------- |
| `constructor` | å»ºæ§‹å‡½å¼ï¼Œå»ºç«‹å¯¦ä¾‹æ™‚æœƒè‡ªå‹•å‘¼å«  |
| `this`        | æŒ‡å‘ç›®å‰é€™å€‹ç‰©ä»¶çš„å¯¦ä¾‹          |
| å¯¦ä¾‹æ–¹æ³•      | `sayHello()` æ˜¯æ¯å€‹äººéƒ½æœ‰çš„æ–¹æ³• |

ä»¥ä¸Šæ˜¯æœ€åŸºæœ¬çš„ç”¨æ³•ï¼Œ JavaScript ä¸­ class é‚„æœ‰åˆ†å…¬é–‹ / ç§æœ‰å±¬æ€§ï¼ˆES2022ï¼‰

#### å…¬é–‹å±¬æ€§

```c
class Dog {
  name = 'Doggy'

  bark() {
    console.log(`${this.name} says woof`)
  }
}

```

#### ç§æœ‰å±¬æ€§ï¼ˆES2022ï¼‰

```c
class Secret {
  #secret = '1234'  // ç§æœ‰

  showSecret() {
    console.log(this.#secret)
  }
}

```

`#secret` åªèƒ½åœ¨ class è£¡ç”¨ï¼Œå¤–éƒ¨è¨ªå•æœƒå ±éŒ¯ï¼å¦‚æœ`console.log(Secret.#secret)`æœƒå¾—åˆ°éŒ¯èª¤æç¤ºè·Ÿä½ èªªä»–æ˜¯ç§æœ‰å±¬æ€§ã€‚

```
VM1208:8 Uncaught Error: Cannot read private member #secret from an object whose class did not declare it
    at <anonymous>:8:13
```

#### éœæ…‹å±¬æ€§èˆ‡æ–¹æ³•ï¼ˆstaticï¼‰

éœæ…‹æˆå“¡å±¬æ–¼ class æœ¬èº«ï¼Œä¸å±¬æ–¼å€‹åˆ¥ç‰©ä»¶ã€‚æ„æ€æ˜¯å¯¦ä¾‹åŒ–å¾Œ(new å¾Œçš„å¯¦ä¾‹)æ˜¯å–ä¸åˆ° static å±¬æ€§çš„ã€‚

```c
class Person {
  static species = 'Human'

  constructor(name) {
    this.name = name
  }

  static getSpecies() {
    return Person.species
  }
}

console.log(Person.getSpecies()) // 'Human', ä¸éœ€è¦å»ºç«‹å¯¦ä¾‹å°±å¯ç”¨

const Alice = new Person('Alice')
console.log(Alice.species) // undefined

```

`static` ç”¨ä¾†åšã€Œè·Ÿå¯¦ä¾‹ç„¡é—œã€çš„äº‹æƒ…ï¼Œä¾‹å¦‚ï¼šå…¨éƒ¨å¯¦ä¾‹ã€Œå…±äº«ã€çš„è³‡è¨Šã€å·¥å…·æ–¹æ³•ï¼ˆex. è½‰æ›ã€æª¢æŸ¥æ ¼å¼ï¼‰ã€å·¥å» æ¨¡å¼ï¼ˆå»ºç«‹ä¸åŒå¯¦ä¾‹ï¼‰ã€‚æˆ‘å€‘å†ä¾†çœ‹ä¸€å€‹ä¾‹å­ï¼Œç”¨ static åšä¸€å€‹é©—è­‰å·¥å…·ï¼š

```c
class Validator {
  static isEmail(str: string): boolean {
    return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(str)
  }

  static isStrongPassword(pwd: string): boolean {
    return pwd.length >= 8 && /[A-Z]/.test(pwd) && /\d/.test(pwd)
  }
}

// ç”¨æ³•ï¼š
console.log(Validator.isEmail('test@example.com'))  // true
console.log(Validator.isStrongPassword('abc'))      // false
```

#### ç¹¼æ‰¿èˆ‡è¦†å¯«ï¼ˆextends / Overrideï¼‰

##### ä»€éº¼æ˜¯ã€Œç¹¼æ‰¿ã€èˆ‡ã€Œè¦†å¯«ã€ï¼Ÿ
-ç¹¼æ‰¿ï¼šè®“ä¸€å€‹é¡åˆ¥å¾ã€Œçˆ¶é¡åˆ¥ã€å–å¾—å±¬æ€§èˆ‡æ–¹æ³•ï¼Œä¸ç”¨é‡è¤‡å¯«

-è¦†å¯«ï¼šè®“å­é¡åˆ¥è‡ªè¡Œå®šç¾©æˆ–æ”¹å¯«çˆ¶é¡çš„è¡Œç‚º

```c
class Animal {
  constructor(name) {
    this.name = name
  }

  speak() {
    console.log(`${this.name} makes a sound`)
  }
}

class Dog extends Animal {
  speak() {
    super.speak() // å‘¼å«çˆ¶é¡åˆ¥æ–¹æ³•
    console.log(`${this.name} barks`)
  }
}

const dog = new Dog('Lucky')
dog.speak()

// Lucky makes a sound.
// Lucky barks.
```

##### super çš„ç”¨é€”
- super():å»ºæ§‹å­ä¸­å‘¼å«çˆ¶é¡çš„ constructorï¼Œå¿…é ˆåœ¨ this å‰é¢
- super.method()ï¼šå‘¼å«çˆ¶é¡åˆ¥çš„æ–¹æ³•

**å»ºæ§‹å­ä¸­å¿…é ˆå‘¼å« super() æ‰å¯ç”¨ this**

```c
class Cat extends Animal {
  constructor(name: string) {
    super(name) // âœ… å¿…é ˆå…ˆå‘¼å« superï¼Œæ‰å¯ç”¨ this
    console.log(`A cat named ${this.name} was created.`)
  }
}
```

#### getter / setter


get value()	è®€å–æ™‚åŸ·è¡Œï¼Œç”¨ä¾†æ”¶é›†ä¾è³´
set value(newVal)	è¨­å®šæ™‚åŸ·è¡Œï¼Œç”¨ä¾†æ›´æ–°å€¼ä¸¦è§¸ç™¼è®ŠåŒ–

getter / setter å…¶å¯¦å°±æ˜¯ vue ref éŸ¿æ‡‰å¼çš„æ ¸å¿ƒï¼ŒVue ref.value æœƒæœ‰ã€Œè®€è¦è¿½è¹¤ã€å¯«æœƒé€šçŸ¥ã€çš„è¡Œç‚ºï¼Œéƒ½æ˜¯é€é get value() / set value() åŒ…è£è€Œä¾†ã€‚

```c
class Test {
  private _x = 1

  get x() {
    console.log('get è¢«å«äº†')
    return this._x
  }

  set x(val: number) {
    console.log('set è¢«å«äº†')
    this._x = val
  }
}

const t = new Test()
console.log(t.x)    // get è¢«å«äº† â†’ å°å‡º 1
t.x = 99            // set è¢«å«äº† â†’ _x è®Šæˆ 99
```

---

### TS class ç”¨æ³•

ä½†å¦‚æœå¯«æˆ TS è¦æ€éº¼å¯«å‘¢ï¼Ÿ TS çš„ä¿®é£¾è©æ¯”èµ· JS å¤šäº† `protected` å’Œ `readonly`

æˆ‘å€‘å…ˆä¾†äº†è§£ä¸€ä¸‹ä¿®é£¾è©ï¼ŒTS çš„ä¿®é£¾è©æœ‰å››å€‹
- publicï¼šå¤–éƒ¨å¯å­˜å–ï¼Œå°±æ˜¯ JS çš„ `this.name = 'x'`
- privateï¼šåƒ… class å…§å¯å­˜å–ï¼ŒJS ç”¨ `#name = 'x'`ï¼Œ# è¡¨ç¤ºç§æœ‰å±¬æ€§
- protectedï¼šåƒ… class å’Œå­é¡åˆ¥(ç”¨super)å¯å­˜å–ï¼ŒåŸç”Ÿ JS ä¸æ”¯æŒï¼Œåªèƒ½ç”¨ TS
- readonlyï¼šå”¯è®€å±¬æ€§ï¼Œå»ºç«‹å¾Œä¸èƒ½æ”¹ï¼Œåªèƒ½ç”¨ TS ä½†å¯ä»¥ç”¨ JS æ¨¡æ“¬

```c
class Person {
  public name: string         // å¤–éƒ¨å¯å­˜å–
  private age: number         // åƒ… class å…§å¯å­˜å–
  protected gender: string    // åƒ… class å’Œå­é¡åˆ¥å¯å­˜å–
  readonly id: number         // å”¯è®€å±¬æ€§ï¼Œå»ºç«‹å¾Œä¸èƒ½æ”¹

  constructor(name: string, age: number, gender: string, id: number) {
    this.name = name
    this.age = age
    this.gender = gender
    this.id = id
  }

  static species = 'human'   // é¡åˆ¥å±¬æ€§ï¼Œä¸å±¬æ–¼å€‹åˆ¥ instance
}
```

å†ä¾†çœ‹çœ‹ä½¿ç”¨çµæœï¼š

```c
const p = new Person('Alice', 30, 'female', 1234)

console.log(p.name)   // âœ… 'Alice'
p.name = 'Bob'        // âœ… å¯ä»¥ä¿®æ”¹

console.log(p.id)     // âœ… 1234
p.id = 5678           // âŒ Errorï¼šCannot assign to 'id' because it is a read-only property

console.log(p.age)    // âŒ Errorï¼šProperty 'age' is private and only accessible within class 'Person'

console.log(p.gender) // âŒ Errorï¼šProperty 'gender' is protected and only accessible within class 'Person' and its subclasses
```

å†ä¾†çœ‹çœ‹å­é¡åˆ¥ä½¿ç”¨æ™‚ï¼š
```c
class Employee extends Person {
  constructor(name: string, age: number, gender: string, id: number) {
    super(name, age, gender, id)
    console.log(this.name)    // âœ… public â†’ å¯è®€
    console.log(this.gender)  // âœ… protected â†’ å­é¡åˆ¥å¯ç”¨
    // console.log(this.age)  // âŒ private â†’ å­é¡åˆ¥ä¹Ÿä¸èƒ½ç”¨
  }
}
```

æœ€å¾Œæˆ‘å€‘å†ä¾†æ•´ç†ä¸€ä¸‹ class çš„å„ç¨®ç”¨æ³•ï¼š

#### class è£¡é¢å¯ä»¥æ”¾ä»€éº¼ï¼Ÿ

| é¡å‹        | èªªæ˜                            | JS æ”¯æ´          | TS æ”¯æ´       |
| ----------- | ------------------------------- | ---------------- | ------------- |
| constructor | å»ºæ§‹å­ï¼Œå»ºç«‹ç‰©ä»¶æ™‚æœƒè¢«å‘¼å«      | âœ…               | âœ…            |
| method      | æ™®é€šçš„æ–¹æ³•ï¼ˆfunctionï¼‰          | âœ…               | âœ…            |
| get/set     | å±¬æ€§çš„ getter å’Œ setter         | âœ…               | âœ…            |
| public      | å…¬é–‹å±¬æ€§ï¼ˆTypeScript é™å®šèªæ³•ï¼‰ | âŒ               | âœ…            |
| private     | ç§æœ‰å±¬æ€§ï¼Œåªèƒ½ class å…§éƒ¨ä½¿ç”¨   | âŒï¼ˆæ–°èªæ³•æ”¯æ´ï¼‰ | âœ…            |
| protected   | å—ä¿è­·å±¬æ€§ï¼Œå­é¡åˆ¥ä¹Ÿèƒ½ç”¨        | âŒ               | âœ…            |
| readonly    | å”¯è®€å±¬æ€§ï¼Œä¸èƒ½ä¿®æ”¹ï¼ˆTS é™å®šï¼‰   | âŒ               | âœ…            |
| static      | é¡åˆ¥å±¬æ€§ï¼Œä¸å±¬æ–¼å¯¦ä¾‹            | âœ…               | âœ…            |
| #private    | çœŸæ­£çš„ JS ç§æœ‰å±¬æ€§ï¼ˆæ–°æ¨™æº–ï¼‰    | âœ…               | ï¼ˆES2022ï¼‰ âœ… |


---

é›–ç„¶ä¸€èˆ¬ç¶²ç«™é–‹ç™¼ä¸­ï¼Œç”¨åˆ° class çš„æ©Ÿæœƒå…¶å¯¦ä¸é«˜ï¼Œå› ç‚ºå¤§éƒ¨åˆ†æ¡†æ¶éƒ½å¹«ä½ åšæ‰éœ€è¦ç”¨ class çš„éƒ¨åˆ†ï¼Œä½†é‚„æ˜¯æœ‰äº›æƒ…æ³å¯ä»¥ä½¿ç”¨ï¼Œåƒæ˜¯è¤‡é›œçš„å•†æ¥­é‚è¼¯ã€æ•´åˆ axios / useFetch ç­‰ç­‰ infraï¼Œæˆ–æ˜¯æœ‰ TS çš„å°ˆæ¡ˆæ­é… class å¯ä»¥å¯«å‡ºæ›´çµæ§‹åŒ–ã€å¯é æ¸¬ã€å¯é‡ç”¨çš„ç¨‹å¼ç¢¼ã€‚
