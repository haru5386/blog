---
title: 網路怎麼讓資料互相傳？一篇看懂 TCP/IP 四層模型
date: 2025-04-14
category: basics
abstract: 你知道每次開啟網頁、看影片、傳訊息，背後其實都有一套「說話的規則」在運作嗎？這些規則就叫做網路協議（Protocol），而 TCP/IP 是其中最重要的基礎。本篇文章會用「寄信」和「人與人溝通」作為比喻，帶你輕鬆理解 TCP/IP 四層模型，幫助你掌握 HTTP 請求是如何透過網路送達伺服器的，還會解釋 TCP 如何重用連線來提升效能。
tags: [TCP/IP, 網路基礎]
---

### 網路協議（Protocol）是什麼？

你可以把協議想像成不同國家間的外交規則或人與人溝通的語言規則。每個國家的都自己的語言，但為了交流，他們會使用一些通用的語言，比如英文。並且會有一些基本規則，確保溝通的準確性。例如：

- 一個人說話時，另一個人聽
- 使用共同理解的語言
- 使用問候語開始對話
- 告別語結束對話

網路協議的概念也是像這樣，讓不同的電腦系統能夠彼此對話和交換資料。

---

### TCP/IP：網際網路的基礎架構

TCP/IP（傳輸控制協議/網際網路協議）是讓網際網路運作的核心技術組合。這就像是網路世界的通用語言和郵政系統，讓不同電腦能夠相互溝通。
它不是一個單一的協定，而是**一組**協定的集合，用來保證**資料能從一台電腦傳到另一台電腦**，不管它們在哪裡。

他最主要的兩個核心部分是：

- TCP（傳輸控制協議）：確保資料能可靠、完整地傳輸
- IP（網際網路協議）：負責資料要送到何處

雖說主要的概念是這兩個協議，但為了讓資料能更有效地傳輸，還會有其他協議的輔助。

---

#### TCP/IP 的四層模型

我們直接先用表格來看一下：

| 層級                   | 功能                                 | 常見協定                    |
| ---------------------- | ------------------------------------ | --------------------------- |
| 應用層 (Application)   | 提供使用者服務，如瀏覽網頁、寄信等   | HTTP、HTTPS、FTP、SMTP、DNS |
| 傳輸層 (Transport)     | 負責資料的分段、傳送、確認與錯誤檢查 | TCP、UDP                    |
| 網際層 (Internet)      | 負責路由與 IP 位址的處理             | IP、ICMP、ARP               |
| 實體/網路介面層 (Link) | 和硬體相關，負責實際資料傳輸         | Ethernet、Wi-Fi、PPP        |

##### 我們用更簡單的例子來解釋 TCP/IP 各層的功能，以及它們如何協同工作。

想像你要寄一封信給住在另一個城市的朋友：

###### 1. 應用層（HTTP、HTTPS 等）

就像你寫信的內容。比如「你好嗎？下週我要來你家玩」。這層處理的是「要說什麼」。

- HTTP 就像是一種特定的寫信格式，讓對方知道你是在請求資訊或是分享資訊
- 這就像是人與人之間的溝通方式

###### 2. 傳輸層（TCP、UDP）

就像你把信放進信封，並確保信件完整送達。

  **TCP：** 相當於掛號信，會確認對方是否收到，如果對方沒收到會重新寄送。  

    - 有「三次握手」確認連接：「我要寄信給你」→「好的，我準備收信了」→「好，我開始寄了」
    - 有「四次揮手」結束連接：「我信寄完了」→「好的，我知道了」→「我也沒什麼要寄了」→「好的，結束了」
    - 會確保信件按順序抵達，不會亂掉

  **UDP：** 相當於普通郵件，丟出去就不管了，可能送達也可能不送達，但速度更快。這種傳輸方式多用在遊戲上。

###### 3. 網絡層（IP）

就像在信封上寫地址（IP 地址），確保信件送到正確的城市和建築物。  
負責找路：「從台北到高雄，先走國道一號，再轉國道三號...」。  
當資料要跨越不同網絡時，決定走哪條路徑最合適。  

###### 4. 鏈路層（以太網、Wi-Fi 等）

就像實際的交通工具（郵車、火車、飛機）和路徑，負責在物理媒介上傳輸資料。

- 把資料變成電信號、光信號或無線電波在網路線、光纖或空氣中傳遞。  
- 處理如何在實體連接的電腦間傳送資料位元。  

---

#### 概念都了解後，接下來我們舉一個實際的例子：

當你在瀏覽器輸入 `www.example.com` 時：

1. 應用層：瀏覽器創建 HTTP 請求「請給我主頁」
2. 傳輸層：TCP 將這個請求分割成多個數據包，標記序號，確保可靠傳輸
3. 網絡層：IP 在每個數據包加上目標伺服器的 IP 地址
4. 鏈路層：將數據包轉換成電信號，通過網路線傳出

當伺服器收到請求後，同樣通過這四層，但是**反向處理**：

1. 鏈路層：接收電信號，轉回數據包
2. 網絡層：檢查 IP 地址，確認是發給自己的
3. 傳輸層：TCP 重組所有數據包，確認完整性
4. 應用層：HTTP 解析請求，決定返回什麼網頁內容

然後伺服器的回應（網頁內容）又通過相同的四層返回到你的瀏覽器，**不管瀏覽器、或是伺服器都有接受和發送的功能。**。

![8-1](/images/post/8-1.png)

這就是為什麼說每次網絡通信都必須經過 TCP/IP 的四層，因為每層都有不可或缺的功能。不過，TCP 連接建立後（完成三次握手），可以重複使用這個連接發送多次 HTTP 請求，不需要每次都重新建立連接。

實作上伺服器可透過設定 `keep-alive` 等機制控制 TCP 連線的存活時間。當網頁加載時，前端往往會發出多個 HTTP/HTTPS 請求，這些請求可以共用一條已建立的 TCP 連線（連線重用），避免每次都進行 TCP 三次握手與 TLS 握手，從而提升載入效能並減少延遲。

